const tabs = [
    {
        "name": "Продукты",
        "type": "products"
    },
    {
        "name": "Инструменты",
        "type": "instruments"
    },
    {
        "name": "Бытовое",
        "type": "household"
    },
    {
        "name": "Прочее",
        "type": "other"
    }
]
const products = {
    "products": [
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца 2",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца 4",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Торт",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца 2",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца 4",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Торт",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        }
    ],
    "instruments": [
        {
            "name": "Пила",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Молоток",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        }
    ],
    "household": [
        {
            "name": "Скотч",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        }
    ],
    "other": [
        {
            "name": "Ножницы",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        },
        {
            "name": "Пицца",
            "image": "pizza.png",
            "price": "100"
        }
    ]
}
// ~~> Получаем фреймы
const tubButtonsFrame = document.querySelector(".shop__tab-items");
const productsFrame = document.querySelector(".shop__products");

// ~> Чистим рендерим и кнопки
if (tubButtonsFrame) {
    tubButtonsFrame.innerHTML = "";
    createTabButtons(tabs, tubButtonsFrame);
}
// ~> Чистим рендерим и товары
if (productsFrame) {
    productsFrame.innerHTML = "";
    createProductsCard(products, productsFrame, "products");
}



/**
 * Рендерит кнопки табов и привязывает к ним события
 *
 * @param {object} tabs массив с элементами табов.
 * @param {object} tubButtonsFrame фрейм в которых необходимо отрендерить табы.
 */
function createTabButtons(tabs, tubButtonsFrame) {
    tabs.forEach((tab, index) => {
        const button = createElement(
            tubButtonsFrame,
            "button",
            index === 0 ? "shop-tabs__button shop-tabs__button--active" : "shop-tabs__button",
            "beforeend",
            tab["type"]);
        button.insertAdjacentText("beforeend", tab["name"])
        button.addEventListener("click", () => {
            const buttons = document.querySelectorAll(".shop-tabs__button");
            buttons.forEach(button => button.classList.remove("shop-tabs__button--active"));
            button.classList.add("shop-tabs__button--active");
            productsFrame.innerHTML = "";
            createProductsCard(products, productsFrame, tab["type"]);
        });
    });
}

/**
 * Рендерит товары и привязывает к ним события
 *
 * @param {object} products массив с товарами.
 * @param {object} productsFrame фрейм в которых необходимо отрендерить товары.
 * @param {string} currentType тип товаров которые необходимо отрендерить.
 */
function createProductsCard(products, productsFrame, currentType) {
    products[currentType].forEach(product => {
        const card = createElement(
            productsFrame,
            "div",
            "shop-card",
            "beforeend"
        );

        card.insertAdjacentHTML("afterbegin", `
            <div class="shop-card__info">
              <p class="shop-card__name">${product["name"]}</p><img class="shop-card__image" src="/img/${product["image"]}">
              <p class="shop-card__price">$${product["price"]}</p>
            </div>
        `)

        const buttonFrame = createElement(card, "div", "shop-card__buttons", "beforeend");
        createIconButton(
            "afterbegin",
            buttonFrame,
            "shop-card__button",
            "shop-card__icon",
            "icon-wallet",
            "bay",
            "wallet",
            `{"name": ${product["name"]},"price": ${product["price"]}}`
        );
        createIconButton(
            "beforeend",
            buttonFrame,
            "shop-card__button",
            "shop-card__icon",
            "icon-card",
            "bay",
            "card",
            `{"name": ${product["name"]},"price": ${product["price"]}}`
        );
    })
}

/**
 * Создает элемент и добавляет его в дерево
 *
 * @param {object} wrap фрейм элемента.
 * @param {string} classNames классы элемента.
 * @param {string} position позиция добавляемого элемента для insertAdjacentElement.
 */
function createElement(wrap, tag, classNames, position, dataType) {
    const userData = document.createElement(tag);
    userData.classList = classNames;
    if (dataType) userData.setAttribute("data-type", dataType);
    return wrap.insertAdjacentElement(position, userData);
}

/**
 * Создает кнопку и добавляет ее в дерево и добавляет к ней отслеживание событий
 *
 * @param {string} position позиция добавляемого элемента для insertAdjacentElement.
 * @param {object} wrap фрейм элемента.
 * @param {string} classNames классы элемента.
 * @param {string} classNamesIcon классы иконки у элемента.
 * @param {string} icon иконка.
 * @param {string} eventTarget Цель к которой приводит кнопка.
 * @param {string} eventType Тип события.
 * @param {object} eventData Информация о покупке
 */
function createIconButton(position, wrap, classNames, classNamesIcon, icon, eventTarget, eventType, eventData) {
    let button = document.createElement("button");
    button.classList = classNames;

    if (eventTarget) button.setAttribute("data-target", eventTarget);
    if (eventType) button.setAttribute("data-type", eventType);
    if (eventData) button.setAttribute("data", eventData);

    button.insertAdjacentHTML("afterbegin", `
        <svg class=${classNamesIcon}><use xlink:href="img/sprites/sprite.svg#${icon}"></use></svg>
    `);
    button.addEventListener("click", () => {
        console.log(eventData);
    })
    return wrap.insertAdjacentElement(position, button);
}